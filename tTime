local _hostname = "https://limitless-hollows-7191.herokuapp.com"


os.loadAPI("mc/json")

function httpGetLastLog()
  str = http.get(_hostname .. "/playlogs/last").readAll()
  obj = json.decode(str)
  return obj
end

function httpPostLog(obj)
	str = json.encode(obj) 
	headers = {}
	headers["Content-Type"] = "application/json"
	ret = http.post(_hostname .. "/playlogs",str, headers).readAll()
  return ret
end

function GetPlayLogObject()

	local playlog = {}
	playlog.timeleft=60
	playlog.gametime=os.clock()
	return playlog
end

function SecondsToPrettyTime(secs)
   min = string.format("%02d",math.floor(secs/60))
   sec = string.format("%02d",math.fmod(secs, 60))
	 return min .. ":" .. sec 
end

function main()
  log = GetPlayLogObject()
	ret = httpPostLog(log)
	status = httpGetLastLog()

	timeToPlay = tonumber(status.timeleft)
	timeLeft = timeToPlay

for i=timeToPlay, 0 do
    --term.clear() --clears the screen
    --term.setCursorPos(1, 1) --sets the cursor to 1,1
    sleep(1) 
	  print("time left:  " .. SecondsToPretty(i))	
end

end

main()



